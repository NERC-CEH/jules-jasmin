<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:xi="http://www.w3.org/2001/XInclude"
      xmlns:py="http://genshi.edgewall.org/">
<xi:include href="../layout.html" />
<head>
    <title>Create Model Run | Submit</title>
    <link rel="stylesheet" type="text/css" href="../layout/joj.css"/>
    <link rel="stylesheet" type="text/css" href="../layout/model_run_submit.css"/>
    <script src="../js/model_run_submit.js"></script>
</head>
<body id="create">
<h1>Submit Model Run</h1>
<p>Your model run is ready to submit. Below is a summary of your choices for this model run - review them and then submit your run.</p>
<div class="edit-rows">
    <div class="row summary">
        <div id="edit-create-page" class="span1 edit">
            <div class="icon">
                <a href="${h.url(controller='model_run', action='create')}" class="edit">
                    <i class="fa fa-edit fa-2x"></i>
                </a>
            </div>
        </div>
        <div class="span11">
            <div id="create-page" class="page-group">
                <h3>${c.model_run.name}</h3>
                <p>${c.model_run.description}</p>
                <p><b>Science Configuration - </b>${c.science_config.name}</p>
            </div>
        </div>
    </div>

    <div class="row summary">
        <div id="edit-driving-page" class="span1 edit">
            <div class="icon">
                <a href="${h.url(controller='model_run', action='driving_data')}" class="edit">
                    <i class="fa fa-edit fa-2x edit"></i>
                </a>
            </div>
        </div>
        <div class="span11">
            <div id="driving-page" class="page-group">
                <p><b>Driving Data - </b>${c.driving_data_name}</p>
            </div>
        </div>
    </div>

    <div class="row summary">
        <div id="edit-extents" class="span1 edit">
            <div class="icon">
                <a href="${h.url(controller='model_run', action='extents')}" class="edit">
                    <i class="fa fa-edit fa-2x edit"></i>
                </a>
            </div>
        </div>
        <div class="span11">
            <div id="extents" class="page-group">
                <py:choose>
                    <py:when test="c.extents_values['site'] == 'single'">
                        <p><b>Site Location - </b>${c.extents_values['lat']}&deg;N, ${c.extents_values['lon']}&deg;E
                            <py:if test="'average_over_cell' in c.extents_values">
                                <br/><small>Using Cell average</small>
                            </py:if>
                        </p>
                    </py:when>
                    <py:otherwise>
                        <p><b>Spatial Extents - </b>${c.extents_values['lat_s']}&deg;N to ${c.extents_values['lat_n']}&deg;N;
                            ${c.extents_values['lon_w']}&deg;E to ${c.extents_values['lon_e']}&deg;E</p>
                    </py:otherwise>
                </py:choose>
                <p><b>Temporal Extents - </b>${c.extents_values['start_date']} to ${c.extents_values['end_date']}</p>
            </div>
        </div>
    </div>

    <div class="row summary">
        <div id="edit-land-cover-page" class="span1 edit">
            <div class="icon">
                <a href="${h.url(controller='model_run', action='land_cover')}" class="edit">
                    <i class="fa fa-edit fa-2x edit"></i>
                </a>
            </div>
        </div>
        <div class="span11">
            <div id="land-cover-page" class="page-group">
                <py:choose>
                    <py:when test="c.extents_values['site'] == 'single'">
                        <py:choose>
                            <py:when test="'land_cover_ice' in c.land_cover_values">
                                <p><b>Fractional Land Cover - </b>Cell is 100% ice</p>
                            </py:when>
                            <py:otherwise>
                                <p><b>Fractional Land Cover:</b></p>
                                <ul>
                                    <py:for each="lc_val in c.land_cover_types">
                                        <li py:if="lc_val.id != c.ice_index">
                                            ${lc_val.name}: ${c.land_cover_values['land_cover_value_' + str(lc_val.id)]} %
                                        </li>
                                    </py:for>
                                </ul>
                            </py:otherwise>
                        </py:choose>
                    </py:when>
                    <py:otherwise>
                        <py:choose>
                            <py:when test="len(c.land_cover_actions) == 0">
                                <p><b>Land Cover Edits - </b>No land cover edits made</p>
                            </py:when>
                            <py:otherwise>
                                <p><b>Land Cover Edits:</b></p>
                                <ul>
                                    <li py:for="action in c.land_cover_actions">
                                        Change ${action.region.name} (${action.region.category.name}) to ${action.value.name}
                                    </li>
                                </ul>
                            </py:otherwise>
                        </py:choose>
                    </py:otherwise>
                </py:choose>
            </div>
        </div>
    </div>

    <div class="row summary">
        <div id="edit-output" class="span1 edit">
            <div class="icon">
                <a href="${h.url(controller='model_run', action='output')}" class="edit">
                    <i class="fa fa-edit fa-2x edit"></i>
                </a>
            </div>
        </div>
        <div class="span11">
            <div id="output" class="page-group">
                <p><b>Output Variables: </b></p>
                <ul>
                    <li py:for="output in c.outputs">
                        ${output}
                    </li></ul>
            </div>
        </div>
    </div>
</div>
<form class="form-horizontal" method="POST" action="${url(controller='model_run', action='submit')}">
    <div class="controls">
        <input type="submit" class="btn btn-primary btn-large pull-right control-group" name="submit" value="Submit" />
        <input type="submit" class="btn btn-primary btn-large pull-left control-group" name="submit" value="Previous" />
    </div>
</form>

<div class="modal fade hide" id="dataset-preview"></div>
</body>
</html>